{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./src/app/app.component.html","./src/app/home-page/home-page.component.html","./src/app/shared/components/main-layout/main-layout.component.html","./src/app/app-routing.module.ts","./src/app/app.component.scss","./src/app/app.component.ts","./src/app/app.module.ts","./src/app/home-page/home-page.component.scss","./src/app/home-page/home-page.component.ts","./src/app/shared/alert.service.ts","./src/app/shared/auth.interceptor.ts","./src/app/shared/components/main-layout/main-layout.component.scss","./src/app/shared/components/main-layout/main-layout.component.ts","./src/app/shared/shared.module.ts","./src/app/user/shared/services/auth.service.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main-es5.js","sourcesContent":["var map = {\n\t\"./user/user.module\": [\n\t\t\"./src/app/user/user.module.ts\",\n\t\t\"user-user-module\"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";\nmodule.exports = webpackAsyncContext;","module.exports = \"<router-outlet></router-outlet>\\r\\n\"","module.exports = \"<div>\\r\\n  <button\\r\\n          class=\\\"btn btn-link open\\\"\\r\\n          [routerLink]=\\\"['/user', 'dashboard']\\\"\\r\\n  >\\r\\n    Войти в личный кабинет\\r\\n  </button>\\r\\n</div>\\r\\n\"","module.exports = \"<nav class=\\\"navbar main\\\">\\r\\n  <h1>DOE</h1>\\r\\n</nav>\\r\\n\\r\\n<div class=\\\"container\\\">\\r\\n  <router-outlet></router-outlet>\\r\\n</div>\\r\\n\"","import {NgModule} from '@angular/core';\r\nimport {Routes, RouterModule, PreloadAllModules} from '@angular/router';\r\nimport {MainLayoutComponent} from './shared/components/main-layout/main-layout.component';\r\nimport {HomePageComponent} from './home-page/home-page.component';\r\nimport {EventPageComponent} from './user/!event-page/event-page.component';\r\n\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '', component: MainLayoutComponent, children: [\r\n      {path: '', redirectTo: '/', pathMatch: 'full'},\r\n      {path: '', component: HomePageComponent},\r\n     // {path: 'event/:id', component: EventPageComponent}\r\n    ]\r\n  },\r\n  {\r\n    path: 'user', loadChildren: './user/user.module#UserModule'\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes, {\r\n    preloadingStrategy: PreloadAllModules\r\n  })],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule {\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FwcC5jb21wb25lbnQuc2NzcyJ9 */\"","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss']\r\n})\r\nexport class AppComponent {\r\n\r\n}\r\n","import {BrowserModule} from '@angular/platform-browser';\r\nimport {NgModule, Provider} from '@angular/core';\r\nimport {HTTP_INTERCEPTORS} from '@angular/common/http';\r\nimport {registerLocaleData} from '@angular/common';\r\nimport ruLocale from '@angular/common/locales/ru';\r\n\r\nimport {AppRoutingModule} from './app-routing.module';\r\nimport {AppComponent} from './app.component';\r\nimport {MainLayoutComponent} from './shared/components/main-layout/main-layout.component';\r\nimport {HomePageComponent} from './home-page/home-page.component';\r\nimport {SharedModule} from './shared/shared.module';\r\nimport {AuthInterceptor} from './shared/auth.interceptor';\r\nimport {AlertService} from './shared/alert.service';\r\n\r\nregisterLocaleData(ruLocale, 'ru');\r\n\r\nconst INTERCEPTOR_PROVIDER: Provider = {\r\n    provide: HTTP_INTERCEPTORS,\r\n    multi: true,\r\n    useClass: AuthInterceptor\r\n};\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AppComponent,\r\n        MainLayoutComponent,\r\n        HomePageComponent,\r\n\r\n    ],\r\n    imports: [\r\n        BrowserModule,\r\n        AppRoutingModule,\r\n        SharedModule\r\n    ],\r\n    providers: [INTERCEPTOR_PROVIDER, AlertService],\r\n    bootstrap: [AppComponent]\r\n})\r\nexport class AppModule {\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2hvbWUtcGFnZS9ob21lLXBhZ2UuY29tcG9uZW50LnNjc3MifQ== */\"","import {Component, OnInit} from '@angular/core';\r\n\r\n\r\n@Component({\r\n  selector: 'app-home-page',\r\n  templateUrl: './home-page.component.html',\r\n  styleUrls: ['./home-page.component.scss']\r\n})\r\nexport class HomePageComponent implements OnInit {\r\n\r\n\r\n\r\n  constructor() {\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {Subject} from 'rxjs';\r\n\r\nexport type AlertType = 'success' | 'warning' | 'danger'\r\n\r\nexport interface Alert {\r\n  type: AlertType\r\n  text: string\r\n}\r\n\r\n@Injectable()\r\nexport class AlertService {\r\n  public alert$ = new Subject<Alert>()\r\n\r\n  success(text: string) {\r\n    this.alert$.next({type: 'success', text})\r\n  }\r\n\r\n  warning(text: string) {\r\n    this.alert$.next({type: 'warning', text})\r\n  }\r\n\r\n  danger(text: string) {\r\n    this.alert$.next({type: 'danger', text})\r\n  }\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {HttpErrorResponse, HttpEvent, HttpHandler, HttpInterceptor, HttpRequest} from '@angular/common/http';\r\nimport {Observable, throwError} from 'rxjs';\r\nimport {AuthService} from '../user/shared/services/auth.service';\r\nimport {Router} from '@angular/router';\r\nimport {catchError} from 'rxjs/operators';\r\nimport {AlertService} from './alert.service';\r\n\r\n@Injectable()\r\nexport class AuthInterceptor implements HttpInterceptor {\r\n\r\n\r\n    constructor(\r\n        private auth: AuthService,\r\n        private router: Router,\r\n        private alert: AlertService\r\n    ) {\r\n    }\r\n\r\n    intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n        if (this.auth.isAuthenticated()) {\r\n            req = req.clone({\r\n                headers: req.headers.set('Authorization', 'Bearer ' + localStorage.getItem('token'))\r\n            });\r\n        }\r\n        return next.handle(req)\r\n            .pipe(\r\n                catchError((error: HttpErrorResponse) => {\r\n                    console.log('[Interceptor Error]: ', error);\r\n                    if (error.status === 401) {\r\n                        this.auth.logout();\r\n                        this.alert.warning(`Вы не авторизованы. ${error.message.toString()}`);\r\n                        this.router.navigate(['/user', 'login'], {\r\n                            queryParams: {\r\n                                authFailed: true\r\n                            }\r\n                        });\r\n                    } else {\r\n                        this.alert.warning(`${error.message.toString()}`);\r\n                    }\r\n                    return throwError(error);\r\n                })\r\n            );\r\n    }\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3NoYXJlZC9jb21wb25lbnRzL21haW4tbGF5b3V0L21haW4tbGF5b3V0LmNvbXBvbmVudC5zY3NzIn0= */\"","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-main-layout',\r\n  templateUrl: './main-layout.component.html',\r\n  styleUrls: ['./main-layout.component.scss']\r\n})\r\nexport class MainLayoutComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","import {NgModule} from '@angular/core';\r\nimport {HttpClientModule} from '@angular/common/http';\r\n\r\n@NgModule({\r\n  imports: [\r\n    HttpClientModule\r\n  ],\r\n  exports: [\r\n    HttpClientModule\r\n  ]\r\n})\r\nexport class SharedModule {\r\n\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {HttpClient, HttpErrorResponse} from '@angular/common/http';\r\nimport {AuthResponse, Token, User} from '../../../shared/interfaces';\r\nimport {Observable, Subject, throwError} from 'rxjs';\r\nimport {environment} from '../../../../environments/environment';\r\nimport {catchError, tap} from 'rxjs/operators';\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport class AuthService {\r\n\r\n    public error$: Subject<string> = new Subject<string>();\r\n    constructor(private http: HttpClient) {\r\n    }\r\n\r\n    get token(): string {\r\n        const expDate = new Date(localStorage.getItem('tokenExpDate'));\r\n        if (new Date() > expDate) {\r\n            this.logout();\r\n            return null;\r\n        }\r\n        return localStorage.getItem('token');\r\n    }\r\n\r\n    login(user: User): Observable<any> {\r\n        user.returnSecureToken = true;\r\n        return this.http.post(`${environment.API_ENDPOINT}/auth`, user)\r\n            .pipe(\r\n                tap(\r\n                    this.setToken\r\n                ),\r\n                catchError(this.handleError.bind(this))\r\n            );\r\n    }\r\n\r\n    logout() {\r\n        this.setToken(null);\r\n        localStorage.clear();\r\n    }\r\n\r\n    isAuthenticated(): boolean {\r\n        return !!this.token;\r\n    }\r\n\r\n    private handleError(error: HttpErrorResponse) {\r\n        const {message} = error.error.error;\r\n        console.log('handleError', error);\r\n\r\n        switch (message) {\r\n            case 'INVALID_EMAIL':\r\n                this.error$.next('Неверный email');\r\n                break;\r\n            case 'INVALID_PASSWORD':\r\n                this.error$.next('Неверный пароль');\r\n                break;\r\n            case 'EMAIL_NOT_FOUND':\r\n                this.error$.next('Такого email нет');\r\n                break;\r\n        }\r\n\r\n        return throwError(error);\r\n    }\r\n\r\n    private setToken(response: AuthResponse | null) {\r\n        if (response) {\r\n            const jsonToken: Token = JSON.parse(atob(response.token.split('.')[1]));\r\n            localStorage.setItem('tokenExpDate', new Date(+ +jsonToken.exp * 1000).toString());\r\n            localStorage.setItem('token', response.token);\r\n            localStorage.setItem('currentUser', jsonToken.sub);\r\n            console.log(response);\r\n        } else {\r\n            localStorage.clear();\r\n        }\r\n    }\r\n}\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nimport {Environment} from './interface';\r\n\r\nexport const environment: Environment = {\r\n  production: false,\r\n  apiKey: 'AIzaSyBeVNY1dO6dHpkj5e7EOZU2ctA4O-chAvQ',\r\n  API_ENDPOINT: 'http://localhost:8189'\r\n};\r\n\r\n//  'https://divisionofexpenses.herokuapp.com'\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n"],"sourceRoot":""}